
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.6">
    
    
      
        <title>NODDI - Civitan International Neuroimaging Laboratory</title>
      
    
    

      <link rel="stylesheet" href="../../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
<link rel="stylesheet" href="../../css/lightgallery.min.css" />

    

<script src="../../js/lightgallery.min.js"></script>

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#noddi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Civitan International Neuroimaging Laboratory" class="md-header__button md-logo" aria-label="Civitan International Neuroimaging Laboratory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Civitan International Neuroimaging Laboratory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NODDI
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/UAB-CINL/UAB-CINL.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Civitan International Neuroimaging Laboratory" class="md-nav__button md-logo" aria-label="Civitan International Neuroimaging Laboratory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Civitan International Neuroimaging Laboratory
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UAB-CINL/UAB-CINL.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../scanner/">Policies and Procedures</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Policies and Procedures" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Policies and Procedures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../scanner/onboarding/" class="md-nav__link">
        Onboarding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../scanner/training/" class="md-nav__link">
        Training
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../scanner/scheduling/" class="md-nav__link">
        Scheduling and Billing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../scanner/implants/" class="md-nav__link">
        Screening and Implants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../scanner/firmm/" class="md-nav__link">
        FIRMM
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" type="checkbox" id="__nav_2_7" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_7">
          Data Transfer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Transfer" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          Data Transfer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../scanner/data_management/" class="md-nav__link">
        Local Transfer and OSIRIX
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7_2" type="checkbox" id="__nav_2_7_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../scanner/xnat/">XNAT</a>
          
            <label for="__nav_2_7_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="XNAT" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_7_2">
          <span class="md-nav__icon md-icon"></span>
          XNAT
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../scanner/xnat/account/" class="md-nav__link">
        User Registration and Accounts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../scanner/xnat/file_management/" class="md-nav__link">
        File Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../scanner/xnat/projects/" class="md-nav__link">
        XNAT Projects
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../preprocessing/">Image Preprocessing</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Image Preprocessing" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Image Preprocessing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../preprocessing/bids/">BIDS</a>
          
            <label for="__nav_3_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="BIDS" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          BIDS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/bids/principles/" class="md-nav__link">
        Basic BIDS Principles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/bids/practical_heudiconv/" class="md-nav__link">
        Practical HeuDiConv Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/bids/heudiconv_scripts/" class="md-nav__link">
        Example Scripts
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/mriqc/" class="md-nav__link">
        MRIQC
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../preprocessing/fmriprep/">fmriprep</a>
          
            <label for="__nav_3_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="fmriprep" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          fmriprep
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/fmriprep/fmriprep-usage/" class="md-nav__link">
        Using fmriprep on Cheaha
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/fmriprep/fmriprep-scripts/" class="md-nav__link">
        Example fmriprep Scripts
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_5" type="checkbox" id="__nav_3_5" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../preprocessing/qsiprep/">qsiprep</a>
          
            <label for="__nav_3_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="qsiprep" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          qsiprep
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/qsiprep/qsiprep_usage/" class="md-nav__link">
        Using QSIprep on Cheaha
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_6" type="checkbox" id="__nav_3_6" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../preprocessing/hcp_pipelines/">HCP Pipelines</a>
          
            <label for="__nav_3_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="HCP Pipelines" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          HCP Pipelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/hcp_pipelines/structural_pipeline/" class="md-nav__link">
        Structural Pipeline
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Image Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Image Analysis" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Image Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Using CIFTI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Using CIFTI" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Using CIFTI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1_1" type="checkbox" id="__nav_4_1_1" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1_1">
          R
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="R" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_1_1">
          <span class="md-nav__icon md-icon"></span>
          R
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cifti/R/cifti-r.html" class="md-nav__link">
        Walkthrough
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cifti/R/cifti-example.html" class="md-nav__link">
        Example Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          NODDI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        NODDI
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toolbox-edits-for-batch-processing" class="md-nav__link">
    Toolbox Edits for Batch Processing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-and-general-preprocessing" class="md-nav__link">
    Data and General Preprocessing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#job-parameters" class="md-nav__link">
    Job Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-noddi" class="md-nav__link">
    Running NODDI
  </a>
  
    <nav class="md-nav" aria-label="Running NODDI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#createroi" class="md-nav__link">
    CreateROI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fsl2protocol" class="md-nav__link">
    FSL2Protocol
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#makemodel" class="md-nav__link">
    MakeModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch_fitting" class="md-nav__link">
    batch_fitting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conversion-to-nifti" class="md-nav__link">
    Conversion to Nifti
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-batch-script" class="md-nav__link">
    Example Batch Script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    Acknowledgements
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        Resources
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toolbox-edits-for-batch-processing" class="md-nav__link">
    Toolbox Edits for Batch Processing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-and-general-preprocessing" class="md-nav__link">
    Data and General Preprocessing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#job-parameters" class="md-nav__link">
    Job Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-noddi" class="md-nav__link">
    Running NODDI
  </a>
  
    <nav class="md-nav" aria-label="Running NODDI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#createroi" class="md-nav__link">
    CreateROI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fsl2protocol" class="md-nav__link">
    FSL2Protocol
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#makemodel" class="md-nav__link">
    MakeModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch_fitting" class="md-nav__link">
    batch_fitting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conversion-to-nifti" class="md-nav__link">
    Conversion to Nifti
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-batch-script" class="md-nav__link">
    Example Batch Script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    Acknowledgements
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/UAB-CINL/UAB-CINL.github.io/edit/master/docs/analysis/noddi.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="noddi">NODDI<a class="headerlink" href="#noddi" title="Permanent link">&para;</a></h1>
<p>Neurite orientiation dispersion and density imaging (NODDI) is a diffusion weighted imaging technique that estimates microstructural complexity of dendrites and axons <em>in vivo</em>. Full details of the technique can be read about in the <a href="https://www.sciencedirect.com/science/article/pii/S1053811912003539?via%3Dihub">Zhang et al. 2012</a> paper. This page will cover how to set up data for NODDI and how to use it on Cheaha.</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p>NODDI was written as a MATLAB toolbox and can be downloaded from <a href="https://www.nitrc.org/projects/noddi_toolbox">the NITRC website</a>. General instructions on how to use the toolbox as well as a link to the support Google group can be found <a href="http://mig.cs.ucl.ac.uk/index.php?n=Tutorial.NODDImatlab">on their site</a></p>
<p>To access the toolbox in MATLAB, download it and use the following command in the MATLAB terminal</p>
<div class="highlight"><pre><span></span><code><span class="nb">addpath</span><span class="p">(</span><span class="nb">genpath</span><span class="p">(</span><span class="o">&lt;</span><span class="nb">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">noddi</span><span class="o">/</span><span class="n">toolbox</span><span class="o">&gt;</span><span class="p">))</span>
</code></pre></div>
<p>The NODDI toolbox depends on the <a href="https://github.com/NIFTI-Imaging/nifti_matlab">nifti_matlab</a> toolbox as well. Download the toolbox from the linked Github repo and add the toolbox to your Matlab path in the same manner as above.</p>
<h3 id="toolbox-edits-for-batch-processing">Toolbox Edits for Batch Processing<a class="headerlink" href="#toolbox-edits-for-batch-processing" title="Permanent link">&para;</a></h3>
<p>While the toolbox can be used out-of-the-box within an interactive MATLAB session on Cheaha, if you're looking to submit a batch job running NODDI, you will need to make a couple of edits. The toolbox as written causes a pop-up progress window to appear which will not render in a batch job and will cause the job to die. To remove the progress bar, make the following edits in the <code>fitting/batch_fitting.m</code> script:</p>
<ul>
<li>Comment out lines 91 and 92. The lines are:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c">%ppm = ParforProgMon([&#39;Fitting &#39; roifile, &#39; : &#39;], numOfVoxels-current_split_start+1,...</span>
<span class="c">%                    progressStepSize, 400, 80);</span>
</code></pre></div>
<ul>
<li>Comment out lines 119:122. The block should look like:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c">% report to the progress monitor</span>
<span class="c">%if mod(i, progressStepSize)==0</span>
<span class="c">%    ppm.increment();</span>
<span class="c">%end</span>
</code></pre></div>
<ul>
<li>Comment out line 137 <code>%ppm.delete();</code></li>
</ul>
<p>All line numbers are from NODDI v1.05. The exact line numbers may differ in other versions, but all references to the <code>ppm</code> object should be commented out from the <code>batch_fitting.m</code> script.</p>
<h2 id="data-and-general-preprocessing">Data and General Preprocessing<a class="headerlink" href="#data-and-general-preprocessing" title="Permanent link">&para;</a></h2>
<p>NODDI only requires diffusion-weighted images, and anatomical scans are not used in the pipeline and are technically not necessary. Diffusion images should be taken with multiple b-values and directions. Suggested hardware specifications are given in the paper's <a href="https://www.sciencedirect.com/science/article/pii/S1053811912003539?via%3Dihub#s0085">subject and data acquisition section</a>. The HCP protocols have a set of diffusion sequences capable of using NODDI.</p>
<p>Standard preprocessing steps should be performed prior to using the toolbox. This includes distortion and eddy current correction, motion correction, and registration and normalization although these are not absolutely required. Other preprocessing steps can be performed depending on preference. Tools for preprocessing diffusion data include:</p>
<ol>
<li><a href="../../preprocessing/qsiprep/">qsiprep</a></li>
<li><a href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki">FSL</a></li>
<li><a href="https://tortoise.nibib.nih.gov/tortoise">Tortoise</a></li>
<li><a href="https://myneurodoc.readthedocs.io/en/latest/Noddi/01_Noddi_Preprocessing.html">Dr. Rodolphe Nenert's preprocessing pipeline</a></li>
</ol>
<p>Many others exist as well, choose whichever tool seems best for your data. At the end, you will need the following files in order to run NODDI:</p>
<ol>
<li>Preprocessed DWI scan</li>
<li>Voxel mask in the DWI scan space</li>
<li>FSL-stlye bvals and rotated bvecs for the DWI scan. Bvecs are rotated to account for eddy current correction, do not use the raw bvecs.</li>
</ol>
<!-- markdownlint-disable MD046 -->
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The mask defines which voxels will be modelled. For instance, if you want to only model voxels in gray matter, you would want a cortical ribbon mask. Whole brain masks are also valid, just know that the processing takes a long time</p>
</div>
<!-- markdownlint-enable MD046 -->

<!-- markdownlint-disable MD046 -->
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both the preprocessed scan and the mask should either be in uncompressed .nii format or Analyze format (.hdr + .img). Using a compressed nifti file (i.e. .nii.gz) will cause an error to be thrown.</p>
</div>
<!-- markdownlint-enable MD046 -->

<h2 id="job-parameters">Job Parameters<a class="headerlink" href="#job-parameters" title="Permanent link">&para;</a></h2>
<p>Whether you're running NODDI interactively or in a batch job, you can take advantage of its parallel computing capabilities by requesting multiple CPUs. Each voxel in the mask is modelled and takes a very long time if done serially, so it's highly suggested to request multiple CPUs.</p>
<p>In past experience, the following parameters gave satisfactory job efficiency and completed calculation of 400,000 vertices in ~6 hours:</p>
<ul>
<li>CPUS: 16</li>
<li>Total Mem: 32 GB</li>
</ul>
<p>The exact number of CPUs can be altered to either minimize time spent per job or maximize throughput of many jobs.</p>
<h2 id="running-noddi">Running NODDI<a class="headerlink" href="#running-noddi" title="Permanent link">&para;</a></h2>
<p>The toolbox is run with some commands that set up the data in a format NODDI requires and then the fitting itself. A basic NODDI setup will look like the following:</p>
<div class="highlight"><pre><span></span><code><span class="n">CreateROI</span><span class="p">(</span><span class="o">&lt;</span><span class="n">dwi_scan</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">brain_mask</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">output_roi</span><span class="p">.</span><span class="n">mat</span><span class="o">&gt;</span><span class="p">);</span>
<span class="n">protocol</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">FSL2Protocol</span><span class="p">(</span><span class="o">&lt;</span><span class="n">bval</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">bvecs</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">b0_cutoff</span><span class="o">&gt;</span><span class="p">);</span>
<span class="n">noddi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MakeModel</span><span class="p">(</span><span class="s">&#39;WatsonSHStickTortIsoV_B0&#39;</span><span class="p">);</span><span class="w"> </span>
<span class="n">batch_fitting</span><span class="p">(</span><span class="o">&lt;</span><span class="n">roi</span><span class="p">.</span><span class="n">mat</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">protocol</span><span class="p">,</span><span class="w"> </span><span class="n">noddi</span><span class="p">,</span><span class="o">&lt;</span><span class="n">noddi_out</span><span class="p">.</span><span class="n">mat</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">ncpus</span><span class="p">);</span>
</code></pre></div>
<h3 id="createroi">CreateROI<a class="headerlink" href="#createroi" title="Permanent link">&para;</a></h3>
<p>The <code>CreateROI</code> command converts the DWI and brain mask to forms usable by the <code>batch_fitting</code> command and has the following form:</p>
<p><code>CreateROI(&lt;dwi_scan&gt;,&lt;brain_mask&gt;,&lt;output_roi.mat&gt;);</code></p>
<p>It needs the following inputs:</p>
<ul>
<li><code>dwi_scan</code>: the path to the preprocessed DWI image (either .nii or .hdr)</li>
<li><code>brain_mask</code>: the path to the brain mask image (either .nii or .hdr)</li>
<li><code>output_roi.mat</code>: the path and name of the output roi mat file created here. This will be used in the <code>batch_fitting</code> step.</li>
</ul>
<h3 id="fsl2protocol">FSL2Protocol<a class="headerlink" href="#fsl2protocol" title="Permanent link">&para;</a></h3>
<p>The <code>FSL2Protocol</code> function performs some data conversion to the bvals and bvecs files necessary for NODDI analysis. It takes the following inputs:</p>
<p><code>protocol = FSL2Protocol(&lt;bval&gt;,&lt;bvecs&gt;,&lt;b0_cutoff&gt;);</code></p>
<ul>
<li><code>bval</code>: path to the DWI bvals file</li>
<li><code>bvecs</code>: path to the rotated DWI-bvecs file</li>
<li><code>b0_cutoff</code>: optional argument to specify a non-zero value for the b0 shell</li>
</ul>
<!-- markdownlint-disable MD046 -->
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the b0_cutoff, you will need to look at the bvals file. the b0 shells will have the smallest numbers but may not actually be 0. For instance, an HCP DWI sequence had a b0 value of 5. If the same DWI sequence is used for all participants, you only need to check one of the bvals files.</p>
</div>
<!-- markdownlint-enable MD046 -->

<h3 id="makemodel">MakeModel<a class="headerlink" href="#makemodel" title="Permanent link">&para;</a></h3>
<p>The <code>MakeModel</code> function takes the input model name and generates parameters for that model. It has the following form:</p>
<p><code>noddi = MakeModel('WatsonSHStickTortIsoV_B0');</code></p>
<p>According to the <a href="http://mig.cs.ucl.ac.uk/index.php?n=Tutorial.NODDImatlab">NODDI documentation</a>, <code>WatsonSHStickTortIsoV_B0</code> is the internal name for the NODDI model and should not be changed.</p>
<h3 id="batch_fitting">batch_fitting<a class="headerlink" href="#batch_fitting" title="Permanent link">&para;</a></h3>
<p>At this point, the NODDI model will be applied to each voxel in the mask. This is where the bulk of the computation happens and will take the longest time to finish. The <code>batch_fitting</code> function has the following form:</p>
<p><code>batch_fitting(&lt;roi.mat&gt;, protocol, noddi,&lt;noddi_out.mat&gt;, ncpus);</code></p>
<ul>
<li><code>roi.mat</code>: the path to the output ROI generated in the <a href="#createroi">CreateROI</a> step.</li>
<li><code>protocol</code>: the protocol variable generated in the <a href="#fsl2protocol">FSL2Protocol</a> step.</li>
<li><code>noddi</code>: the noddi variable generated in the <a href="#makemodel">MakeModel</a> step</li>
<li><code>noddi_out.mat</code>: the path and name of the generated NODDI output mat file.</li>
<li><code>ncpus</code>: the number of CPUS requested during job creation for parallel processing</li>
</ul>
<h3 id="conversion-to-nifti">Conversion to Nifti<a class="headerlink" href="#conversion-to-nifti" title="Permanent link">&para;</a></h3>
<p>At the end of the pipeline, you will have a <code>.mat</code> file containing the values for the NODDI parameters specified in your model. To convert the <code>.mat</code> file to a Nifti file, use the <code>SaveParamsAsNIfTI</code> function. This function has the following form:</p>
<p><code>SaveParamsAsNIfTI(&lt;noddi_out.mat&gt;, &lt;output_roi.mat&gt;, &lt;target_image&gt;, &lt;output_prefix&gt;)</code></p>
<ul>
<li><code>noddi_out.mat</code>: the path to the output mat file from <code>batch_fitting</code></li>
<li><code>output_roi.mat</code>: the path to the output ROI file from <code>CreateROI</code></li>
<li><code>target_image</code>: the NIfTI file specifying the target 3-D volume the NODDI values should map to.</li>
<li><code>output_prefix</code>: a text string specifying the filename prefix of the output parameter maps.</li>
</ul>
<!-- markdownlint-disable MD046 -->
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For NODDI examples, the target image was set to the brain mask used in the <code>CreateROI</code> step. Remember, this space matches the preprocessed DWI image space. Transforms from DWI space to individual T1 or a standard space can be created and applied to the output NODDI nii files in a further step.</p>
</div>
<!-- markdownlint-enable MD046 -->

<p>At the end, you will have uncompressed .nii files containing 3D volumes for each parameter in the NODDI model.</p>
<h2 id="example-batch-script">Example Batch Script<a class="headerlink" href="#example-batch-script" title="Permanent link">&para;</a></h2>
<p>This script has been tested using the modified NODDI toolbox mentioned in the <a href="#toolbox-edits-for-batch-processing">toolbox edits</a> section. Please read that section and make the necessary modifications first before submitting a batch job running NODDI.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --job-name=noddi</span>
<span class="c1">#SBATCH --partition=amd-hdr100</span>
<span class="c1">#SBATCH --time=24:00:00</span>
<span class="c1">#SBATCH --ntasks=1</span>
<span class="c1">#SBATCH --cpus-per-task=16</span>
<span class="c1">#SBATCH --mem=32G</span>
<span class="c1">#SBATCH --output=/home/mdefende/NODDI_v1.05.txt</span>

module<span class="w"> </span>load<span class="w"> </span>rc/matlab/R2022a

matlab<span class="w"> </span>-nodisplay<span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;addpath(genpath(&#39;/home/mdefende/noddi/nifti_matlab&#39;)); </span>
<span class="s2">addpath(genpath(&#39;/home/mdefende/noddi/NODDI_toolbox_v1.05&#39;));</span>
<span class="s2">CreateROI(&#39;/home/mdefende/noddi/data/sub-S01/sub-S01-AP_PA_eddy.nii&#39;,&#39;/home/mdefende/noddi/sub-S01/unwarp_b0_brain_mask.nii&#39;,&#39;/home/mdefende/noddi/sub-S01/sub-S01-AP_PA_eddy_NODDI_roi.mat&#39;);</span>
<span class="s2">protocol = FSL2Protocol(&#39;/home/mdefende/noddi/sub-S01/sub-S01-AP_PA.bval&#39;,&#39;/home/mdefende/noddi/sub-S01/sub-S01-AP_PA_eddy.eddy_rotated_bvecs&#39;,5);</span>
<span class="s2">noddi = MakeModel(&#39;WatsonSHStickTortIsoV_B0&#39;); </span>
<span class="s2">batch_fitting(&#39;/home/mdefende/noddi/sub-S01/sub-S01-AP_PA_eddy_NODDI_roi.mat&#39;,protocol,noddi,&#39;/home/mdefende/noddi/sub-S01/NODDI_fitted_params.mat&#39;,16);&quot;</span>
</code></pre></div>
<h2 id="acknowledgements">Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permanent link">&para;</a></h2>
<p>Dr. Rodolphe Nenert at UAB helped with the development of this page by providing his own version of NODDI documentation to work off of. Please have a look at his docs at <a href="https://myneurodoc.readthedocs.io/en/latest/index.html">myneurodoc</a> for more information.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../cifti/R/cifti-example.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Example Analysis" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Example Analysis
            </div>
          </div>
        </a>
      
      
        
        <a href="../resources/" class="md-footer__link md-footer__link--next" aria-label="Next: Resources" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Resources
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [{"tabs": true}, "navigation.indexes", "toc.follow"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    

      <script src="../../assets/javascripts/bundle.1514a9a0.min.js"></script>
      
    
<script>
  var elements = document.getElementsByClassName("lightgallery");
  for (var i = 0; i < elements.length; i++) {
    lightGallery(elements[i]);
  }
</script>

  </body>
</html>