
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.6">
    
    
      
        <title>Using QSIprep on Cheaha - Civitan International Neuroimaging Laboratory</title>
      
    
    

      <link rel="stylesheet" href="../../../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
<link rel="stylesheet" href="../../../css/lightgallery.min.css" />

    

<script src="../../../js/lightgallery.min.js"></script>

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-qsiprep-on-cheaha" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Civitan International Neuroimaging Laboratory" class="md-header__button md-logo" aria-label="Civitan International Neuroimaging Laboratory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Civitan International Neuroimaging Laboratory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Using QSIprep on Cheaha
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/UAB-CINL/UAB-CINL.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Civitan International Neuroimaging Laboratory" class="md-nav__button md-logo" aria-label="Civitan International Neuroimaging Laboratory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Civitan International Neuroimaging Laboratory
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UAB-CINL/UAB-CINL.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Policies and Procedures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Policies and Procedures" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Policies and Procedures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../scanner/getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../scanner/onboarding/" class="md-nav__link">
        Onboarding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../scanner/training/" class="md-nav__link">
        Training
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../scanner/scheduling/" class="md-nav__link">
        Scheduling and Billing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../scanner/implants/" class="md-nav__link">
        Screening and Implants
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_6">
          Data Transfer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Transfer" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Data Transfer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../scanner/data_management/" class="md-nav__link">
        Local Transfer and OSIRIX
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6_2" type="checkbox" id="__nav_2_6_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../scanner/xnat/">XNAT</a>
          
            <label for="__nav_2_6_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="XNAT" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_6_2">
          <span class="md-nav__icon md-icon"></span>
          XNAT
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../scanner/xnat/account/" class="md-nav__link">
        User Registration and Accounts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../scanner/xnat/file_management/" class="md-nav__link">
        File Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../scanner/xnat/projects/" class="md-nav__link">
        XNAT Projects
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Image Preprocessing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Image Preprocessing" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Image Preprocessing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../bids/">BIDS</a>
          
            <label for="__nav_3_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="BIDS" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          BIDS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bids/principles/" class="md-nav__link">
        Basic BIDS Principles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bids/practical_heudiconv/" class="md-nav__link">
        Practical HeuDiConv Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bids/heudiconv_scripts/" class="md-nav__link">
        Example Scripts
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mriqc/" class="md-nav__link">
        MRIQC
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../fmriprep/">fmriprep</a>
          
            <label for="__nav_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="fmriprep" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          fmriprep
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fmriprep/fmriprep-usage/" class="md-nav__link">
        Using fmriprep on Cheaha
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fmriprep/fmriprep-scripts/" class="md-nav__link">
        Example fmriprep Scripts
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" checked>
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">qsiprep</a>
          
            <label for="__nav_3_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="qsiprep" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          qsiprep
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Using QSIprep on Cheaha
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Using QSIprep on Cheaha
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-positional-arguments" class="md-nav__link">
    Required Positional Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-arguments" class="md-nav__link">
    Additional Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fieldmaps" class="md-nav__link">
    Fieldmaps
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    Outputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-scripts" class="md-nav__link">
    Example Scripts
  </a>
  
    <nav class="md-nav" aria-label="Example Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-subject" class="md-nav__link">
    Single Subject
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array-job" class="md-nav__link">
    Array Job
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_5" type="checkbox" id="__nav_3_5" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../hcp_pipelines/">HCP Pipelines</a>
          
            <label for="__nav_3_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="HCP Pipelines" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          HCP Pipelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hcp_pipelines/structural_pipeline/" class="md-nav__link">
        Structural Pipeline
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Image Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Image Analysis" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Image Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Using CIFTI in R
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Using CIFTI in R" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Using CIFTI in R
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../R/cifti/cifti-r.html" class="md-nav__link">
        Walkthrough
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../R/cifti/cifti-example.html" class="md-nav__link">
        Example Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../resources/" class="md-nav__link">
        Resources
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-positional-arguments" class="md-nav__link">
    Required Positional Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-arguments" class="md-nav__link">
    Additional Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fieldmaps" class="md-nav__link">
    Fieldmaps
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    Outputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-scripts" class="md-nav__link">
    Example Scripts
  </a>
  
    <nav class="md-nav" aria-label="Example Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-subject" class="md-nav__link">
    Single Subject
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array-job" class="md-nav__link">
    Array Job
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/UAB-CINL/UAB-CINL.github.io/edit/master/docs/analysis/qsiprep/qsiprep_usage.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="using-qsiprep-on-cheaha">Using QSIprep on Cheaha<a class="headerlink" href="#using-qsiprep-on-cheaha" title="Permanent link">&para;</a></h1>
<p>Full documentation on using QSIprep can be found on <a href="https://qsiprep.readthedocs.io/en/stable/usage.html">their docs</a>. Instructions here will cover a selection of their documentation tailored for use on Cheaha.</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p>The suggested way to use QSIprep on Cheaha is through a Singularity container. These containers have all software necessary to run qsiprep packaged together, so no environments or external software management is necessary. To install the Singularity container for QSIprep, open an interactive session on Cheaha and run the following commands:</p>
<div class="highlight"><pre><span></span><code>module load Singularity/3.5.2-GCC-5.4.0-2.26
singularity pull qsiprep-0.14.3.sif docker://pennbbl/qsiprep:0.14.3
</code></pre></div>
<p>The container download and building process will take some time but once complete will not need to be performed again unless you want a different version.</p>
<!-- markdownlint-disable MD046 -->
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The suggested version of QSIprep to install is version 0.14.3, one major version behind as of the writing of these docs. Version 0.15.X have issues with the packaged miniconda distribution that cause runtime errors. Some published issues on QSIprep's github page suggest waiting until the next major release (0.16.1) for resolutions to these issues.</p>
</div>
<!-- markdownlint-enable MD046 -->

<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>The basic command structure for qsiprep is fairly simple:</p>
<div class="highlight"><pre><span></span><code>singularity run &lt;path/to/sif&gt; <span class="o">[</span>optional_args<span class="o">]</span> &lt;bids_dir&gt; &lt;output_dir&gt; &lt;analysis_level&gt;
</code></pre></div>
<h3 id="required-positional-arguments">Required Positional Arguments<a class="headerlink" href="#required-positional-arguments" title="Permanent link">&para;</a></h3>
<ul>
<li><code>bids_dir</code>: root folder of a BIDS-sorted dataset (contains the sub-XXXX BIDS directories)</li>
<li><code>output_dir</code>: path to the qsiprep outputs, typically named <code>derivatives</code> in a BIDS structure</li>
<li><code>analysis_level</code>: currently only <code>participant</code></li>
</ul>
<h3 id="additional-arguments">Additional Arguments<a class="headerlink" href="#additional-arguments" title="Permanent link">&para;</a></h3>
<p>A full description of the optional arguments can be found in the <a href="https://qsiprep.readthedocs.io/en/stable/usage.html">QSIprep documentation</a>. Some select options are listed below, but is nowhere near an exhaustive list. There are a number of options that can dramatically change preprocessing steps, so please read through the linked documentation above to tailor your pipeline to how you want it.</p>
<ul>
<li><code>--participant_label</code>: participant to perform qsiprep on. Omit the <code>sub-</code> tag from the label. While there are ways to specify multiple participants in a single QSIprep script, these will run serially, and perprocessing time will be long. For multiple participants, array scripts are suggested instead for parallel processing.</li>
<li><code>--separate_all_dwis</code>: Default behavior for qsiprep is to concatenate multiple DWI runs together and then perform preprocessing (<a href="https://qsiprep.readthedocs.io/en/stable/preprocessing.html#merging-multiple-scans-from-a-session">see here</a>). This option will keep all DWIs separate during and after preprocessing.</li>
<li><code>output_resolution</code>: isotropic voxel size that DWIs will be resampled to after preprocessing. BSpline interpolation is used for upsampling to smaller voxels than in the raw data. <strong>This is a required argument</strong>.</li>
<li><code>--fs_license_file</code>: path to the FreeSurfer license file. See <a href="../../fmriprep/fmriprep-usage/#freesurfer-license-file">our fmriprep docs</a> for more information. <strong>This is a required argument</strong>.</li>
<li><code>--work_dir</code>: path to a working directory to store intermediate results. These files will be deleted after the script ends.</li>
</ul>
<h3 id="fieldmaps">Fieldmaps<a class="headerlink" href="#fieldmaps" title="Permanent link">&para;</a></h3>
<p>If you are using fieldmaps for distortion correction, remember to include the <a href="../../bids/practical_heudiconv/#associating-fieldmaps-with-func-and-dwi-scans">IntendedFor</a> field in the fieldmap json sidecars naming the diffusion scans they are intended to correct.</p>
<h2 id="outputs">Outputs<a class="headerlink" href="#outputs" title="Permanent link">&para;</a></h2>
<p>A detailed list of qsiprep outputs can be found in <a href="https://qsiprep.readthedocs.io/en/stable/preprocessing.html#outputs-of-qsiprep">their documentation</a>.</p>
<h2 id="example-scripts">Example Scripts<a class="headerlink" href="#example-scripts" title="Permanent link">&para;</a></h2>
<h3 id="single-subject">Single Subject<a class="headerlink" href="#single-subject" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1">#</span>
<span class="c1">#SBATCH --job-name=S01-qsiprep</span>
<span class="c1">#SBATCH --output=qsiprep-S01-out.txt</span>
<span class="c1">#SBATCH --ntasks=1</span>
<span class="c1">#SBATCH --cpus-per-task=4</span>
<span class="c1">#SBATCH --partition=amd-hdr100</span>
<span class="c1">#SBATCH --time=50:00:00</span>
<span class="c1">#SBATCH --mem-per-cpu=10G</span>

<span class="c1"># Users should only need to change the bids_dir and the participant below to run this script.</span>

<span class="c1"># set the path to the dataset directory. This is the parent to the BIDS-formatted nifti directory.</span>
<span class="nv">bids_dir</span><span class="o">=</span><span class="nv">$USER_DATA</span>/D01/nifti

<span class="c1"># set the name of the participant</span>
<span class="nv">participant</span><span class="o">=</span>S01

<span class="c1"># load the module</span>
module load Singularity/3.5.2-GCC-5.4.0-2.26

<span class="c1"># change directory to where qsiprep image file is stored</span>
<span class="nb">cd</span> ~/Scripts/qsiprep

<span class="c1"># run qsiprep</span>
singularity run qsiprep-0.14.3.sif --participant_label <span class="nv">$participant</span> <span class="se">\</span>
    --fs_license_file <span class="nv">$HOME</span>/license.txt <span class="se">\</span>
    -v <span class="se">\</span>
    --separate_all_dwis <span class="se">\</span>
    --output_resolution <span class="m">1</span>.2 <span class="se">\</span>
    --skip_bids_validation <span class="se">\</span>
    <span class="nv">$bids_dir</span> <span class="se">\</span>
    <span class="nv">$bids_dir</span>/derivatives <span class="se">\</span>
    participant
</code></pre></div>
<h3 id="array-job">Array Job<a class="headerlink" href="#array-job" title="Permanent link">&para;</a></h3>
<p>The array job uses the <code>participants.tsv</code> file generated in the main BIDS directory similar to our <a href="../../fmriprep/fmriprep-scripts/#example-array-job-script">fmriprep examples</a>. Array indexes for sbatch are 0's based, i.e. 0 will correspond to the first participant in the tsv file. The array script has been written to account for this.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1">#</span>
<span class="c1">#SBATCH --job-name=qsiprep</span>
<span class="c1">#SBATCH --output=qsiprep-%A-%a.txt</span>
<span class="c1">#SBATCH --ntasks=1</span>
<span class="c1">#SBATCH --cpus-per-task=4</span>
<span class="c1">#SBATCH --partition=amd-hdr100</span>
<span class="c1">#SBATCH --time=50:00:00</span>
<span class="c1">#SBATCH --mem-per-cpu=10G</span>

<span class="c1"># set the path to the BIDS-formatted nifti directory</span>
<span class="nv">bids_dir</span><span class="o">=</span><span class="nv">$USER_DATA</span>/D01/nifti/

<span class="c1"># set the participant id from the participants.tsv file in the bidsdir</span>
<span class="nv">participant</span><span class="o">=</span><span class="k">$(</span>awk <span class="s2">&quot;NR==</span><span class="k">$((</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="o">+</span><span class="m">2</span><span class="k">))</span><span class="s2">{print;exit}&quot;</span> <span class="nv">$bids_dir</span>/participants.tsv <span class="p">|</span> cut -f <span class="m">1</span><span class="k">)</span>

<span class="c1"># load the module</span>
module load Singularity/3.5.2-GCC-5.4.0-2.26

<span class="c1"># change directory to where qsiprep image file is stored</span>
<span class="nb">cd</span> ~/Scripts/qsiprep

<span class="c1"># run qsiprep</span>
singularity run qsiprep-0.14.3.sif --participant_label <span class="nv">$participant</span> <span class="se">\</span>
    --fs_license_file <span class="nv">$HOME</span>/license.txt <span class="se">\</span>
    -v <span class="se">\</span>
    --separate_all_dwis <span class="se">\</span>
    --output_resolution <span class="m">1</span>.2 <span class="se">\</span>
    --skip_bids_validation <span class="se">\</span>
    <span class="nv">$bids_dir</span> <span class="se">\</span>
    <span class="nv">$bids_dir</span>/derivatives <span class="se">\</span>
    participant
</code></pre></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Introduction" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Introduction
            </div>
          </div>
        </a>
      
      
        
        <a href="../../hcp_pipelines/" class="md-footer__link md-footer__link--next" aria-label="Next: Introduction" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Introduction
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [{"tabs": true}, "navigation.indexes", "toc.follow"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    

      <script src="../../../assets/javascripts/bundle.1514a9a0.min.js"></script>
      
    
<script>
  var elements = document.getElementsByClassName("lightgallery");
  for (var i = 0; i < elements.length; i++) {
    lightGallery(elements[i]);
  }
</script>

  </body>
</html>